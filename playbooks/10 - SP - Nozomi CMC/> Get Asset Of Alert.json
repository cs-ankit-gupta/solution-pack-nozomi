{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> Get Asset Of Alert",
    "aliasName": null,
    "tag": null,
    "description": "This PB will fetch assets based on IP address.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "alertData"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/566483c2-686f-4c7d-b8df-eb51583b1814",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/db9a9d63-15fc-4162-87e8-b342e92321d5",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Create Assets",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{vars.steps.Get_Assets.data.result}}",
                    "parallel": false,
                    "condition": ""
                },
                "arguments": {
                    "alertIRI": "{{vars.input.params.alertData['@id']}}",
                    "assetRecord": "{{vars.item}}",
                    "parentAssetIRI": ""
                },
                "apply_async": false,
                "step_variables": {
                    "cVE": "{{vars.steps.Create_Assets | json_query('[*][\"cVE\"][][]') | unique}}",
                    "assetIRI": "{{vars.steps.Create_Assets | json_query('[*][\"asset\"][]')}}",
                    "kevAlert": "{{vars.steps.Create_Assets | json_query('[*][\"kevAlert\"][][]') | unique}}",
                    "iCSAdvisory": "{{vars.steps.Create_Assets | json_query('[*][\"iCSAdvisory\"][][]') | unique}}"
                },
                "pass_parent_env": false,
                "pass_input_record": false,
                "workflowReference": "\/api\/3\/workflows\/9eb98a74-ab4e-4c7b-8ea9-5577ff7eb8ac"
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
            "group": null,
            "uuid": "5055527b-4fc0-4d5e-9408-560fb94b448c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Comment On Asset",
            "description": null,
            "arguments": {
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "assets": "{{vars.assetIRI}}",
                    "people": [],
                    "content": "<p>Correlated following <span class=\"badge badge-pill badge-danger\" style=\"background: #009d00; color: #fff;\">CVEs<\/span> <span class=\"badge badge-pill badge-danger\" style=\"background: #009d00; color: #fff;\">ICS Advisory<\/span> and <span class=\"badge badge-pill badge-danger\" style=\"background: #009d00; color: #fff;\">KEV Alert<\/span> as per CVEs fetch from Nozomi for this Asset.<\/p>\n<h4>CVEs<\/h4>\n<p>{% for item in vars.cVE %}<a href=\"modules\/c_v_es\/{{item.uuid}}\" target=\"_blank\" rel=\"noopener\">{{(item['@id'] | fromIRI).cVEID}}<\/a><br \/>{% endfor %}<\/p>\n<h4>ICS Advisory<\/h4>\n<p>{% for item in vars.iCSAdvisory %}<a href=\"modules\/i_c_s_advisories\/{{item.uuid}}\" target=\"_blank\" rel=\"noopener\">{{(item['@id'] | fromIRI).iCSCERTTitle}}<\/a><br \/>{% endfor %}<\/p>\n<h4>KEV Alert<\/h4>\n<p>{% for item in vars.kevAlert %}<a href=\"modules\/k_e_v_alerts\/{{item.uuid}}\" target=\"_blank\" rel=\"noopener\">{{(item['@id'] | fromIRI).title}}<\/a><br \/>{% endfor %}<\/p>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "5c59b3a4-d172-42e0-bc80-793a0909c25f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Alert With CVEs ICS Advisory and Asset",
            "description": null,
            "arguments": {
                "message": {
                    "tags": [],
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "tenant": "",
                    "thread": false,
                    "content": "<p>Correlated following<span class=\"badge badge-pill badge-danger\" style=\"background: #009d00; color: #fff;\">CVEs<\/span> <span class=\"badge badge-pill badge-danger\" style=\"background: #009d00; color: #fff;\">ICS Advisory<\/span> as per Affected Asset.<\/p>\n<h4>CVEs<\/h4>\n<p>{% for item in vars.cVE %}<a href=\"modules\/c_v_es\/{{item.uuid}}\" target=\"_blank\" rel=\"noopener\">{{(item['@id'] | fromIRI).cVEID}}<\/a><br \/>{% endfor %}<\/p>\n<h4>ICS Advisory<\/h4>\n<p>{% for item in vars.iCSAdvisory %}<a href=\"modules\/i_c_s_advisories\/{{item.uuid}}\" target=\"_blank\" rel=\"noopener\">{{(item['@id'] | fromIRI).iCSCERTTitle}}<\/a><br \/>{% endfor %}<\/p>",
                    "records": "{{vars.input.params.alertData['@id']}}"
                },
                "resource": {
                    "__link": {
                        "assets": "{{vars.assetIRI}}"
                    }
                },
                "operation": "Append",
                "collection": "{{vars.input.params.alertData['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/alerts",
                "fieldOperation": [],
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "7532a1a0-3495-4869-ba64-d5b42fa9d94a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "sourceData": "{{vars.input.params.alertData.sourcedata | toDict}}",
                "useMockOutput": "{{globalVars.Demo_mode}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "7d0e0a5b-b718-42f0-bab9-d65667e38b15"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Assets",
            "description": null,
            "arguments": {
                "name": "Nozomi Networks Central Management Console",
                "config": "b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                "params": {
                    "level": "",
                    "query": "| where mac_address include? {{vars.sourceData['mac_src']}} OR mac_address include? {{vars.sourceData['mac_dst']}}",
                    "max_assets": "",
                    "asset_types": "",
                    "appliance_ids": "{{vars.sourceData['appliance_id']}}"
                },
                "version": "1.0.0",
                "connector": "nozomi-networks-central-management-console",
                "operation": "get_assets",
                "mock_result": "{\n  \"data\": {\n    \"error\": null,\n    \"total\": 1,\n    \"header\": [\n      \"name\",\n      \"level\",\n      \"appliance_hosts\",\n      \"ip\",\n      \"mac_address\",\n      \"mac_vendor\",\n      \"os\",\n      \"roles\",\n      \"vendor\",\n      \"firmware_version\",\n      \"os_or_firmware\",\n      \"serial_number\",\n      \"product_name\",\n      \"type\",\n      \"protocols\",\n      \"nodes\",\n      \"custom_fields\",\n      \"deleted_at\",\n      \"time\",\n      \"synchronized\",\n      \"replicated\",\n      \"appliance_id\",\n      \"appliance_ip\",\n      \"appliance_host\",\n      \"mac_address_level\",\n      \"id\",\n      \"vendor:info\",\n      \"firmware_version:info\",\n      \"product_name:info\",\n      \"serial_number:info\",\n      \"type:info\",\n      \"capture_device\",\n      \"vlan_id\",\n      \"zones\",\n      \"created_at\",\n      \"fields\",\n      \"last_activity_time\",\n      \"appliance_sites\",\n      \"end_of_sale_date\",\n      \"end_of_sale_date:info\",\n      \"end_of_support_date\",\n      \"end_of_support_date:info\",\n      \"lifecycle\",\n      \"lifecycle:info\",\n      \"is_ai_enriched\",\n      \"os:info\"\n    ],\n    \"result\": [\n      {\n        \"id\": \"5683d2cd-dbd1-4666-89ab-fa61359d08af\",\n        \"ip\": [\n          \"10.132.254.110\"\n        ],\n        \"os\": \"Windows 11 \/ 10 \/ Server 2016 \/ Server 2019 \/ Server 2022 \/ Server\",\n        \"name\": \"FSR-PROD-WIN10-\",\n        \"time\": 1679481109061,\n        \"type\": \"computer\",\n        \"level\": \"\",\n        \"nodes\": [\n          \"10.132.254.110\"\n        ],\n        \"roles\": [\n          \"other\"\n        ],\n        \"zones\": [\n          \"10.132.0.0\/16\"\n        ],\n        \"fields\": {},\n        \"vendor\": \"Siemens\",\n        \"os:info\": {\n          \"source\": \"passive\"\n        },\n        \"vlan_id\": [],\n        \"lifecycle\": \"\",\n        \"protocols\": [\n          \"browser\",\n          \"igmp\",\n          \"llmnr\",\n          \"mdns\",\n          \"netbios-ns\",\n          \"ssdp\"\n        ],\n        \"type:info\": {\n          \"source\": \"passive\"\n        },\n        \"created_at\": 1670564522905,\n        \"deleted_at\": 0,\n        \"mac_vendor\": [\n          \"Siemens\"\n        ],\n        \"replicated\": false,\n        \"mac_address\": [\n          \"00:0c:29:5f:74:57\"\n        ],\n        \"vendor:info\": {\n          \"source\": \"passive\",\n          \"confidence\": \"good\",\n          \"granularity\": \"complete\"\n        },\n        \"_asset_kb_id\": \"not_matched\",\n        \"appliance_id\": \"1fb4918e-ed88-4717-82ec-28fec97dd6be\",\n        \"appliance_ip\": \"10.132.254.15\",\n        \"product_name\": \"\",\n        \"synchronized\": false,\n        \"custom_fields\": {},\n        \"serial_number\": \"\",\n        \"appliance_host\": \"nozomi-n2os.local\",\n        \"capture_device\": \"em1\",\n        \"is_ai_enriched\": false,\n        \"lifecycle:info\": {\n          \"source\": \"passive\"\n        },\n        \"os_or_firmware\": \"Windows 11 \/ 10 \/ Server 2016 \/ Server 2019 \/ Server 2022 \/ Server\",\n        \"appliance_hosts\": [\n          \"nozomi-n2os.local\"\n        ],\n        \"appliance_sites\": [],\n        \"end_of_sale_date\": 0,\n        \"firmware_version\": \"\",\n        \"mac_address_level\": {\n          \"00:0c:29:5f:74:57\": \"confirmed\"\n        },\n        \"product_name:info\": {\n          \"source\": \"passive\"\n        },\n        \"last_activity_time\": 1679481098061,\n        \"serial_number:info\": {\n          \"source\": \"passive\"\n        },\n        \"end_of_support_date\": 0,\n        \"end_of_sale_date:info\": {\n          \"source\": \"passive\"\n        },\n        \"firmware_version:info\": {\n          \"source\": \"passive\"\n        },\n        \"end_of_support_date:info\": {\n          \"source\": \"passive\"\n        }\n      }\n    ]\n  }\n}",
                "operationTitle": "Get Assets List",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "a5724d01-3d07-4342-944b-21893822e0d7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "db9a9d63-15fc-4162-87e8-b342e92321d5"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Comment On Asset -> Update Alert With CVEs ICS Advisory and Asset",
            "targetStep": "\/api\/3\/workflow_steps\/7532a1a0-3495-4869-ba64-d5b42fa9d94a",
            "sourceStep": "\/api\/3\/workflow_steps\/5c59b3a4-d172-42e0-bc80-793a0909c25f",
            "label": null,
            "isExecuted": false,
            "uuid": "18f89064-8395-4550-a4ec-d0465c99b9b8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/7d0e0a5b-b718-42f0-bab9-d65667e38b15",
            "sourceStep": "\/api\/3\/workflow_steps\/db9a9d63-15fc-4162-87e8-b342e92321d5",
            "label": null,
            "isExecuted": false,
            "uuid": "38c61e35-c3f3-488e-afeb-0f6cb1d9103a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Assets",
            "targetStep": "\/api\/3\/workflow_steps\/a5724d01-3d07-4342-944b-21893822e0d7",
            "sourceStep": "\/api\/3\/workflow_steps\/7d0e0a5b-b718-42f0-bab9-d65667e38b15",
            "label": null,
            "isExecuted": false,
            "uuid": "3b0b3ece-6ff5-4488-b456-d71cc1cdb774"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Create Assets -> Comment On Asset",
            "targetStep": "\/api\/3\/workflow_steps\/5c59b3a4-d172-42e0-bc80-793a0909c25f",
            "sourceStep": "\/api\/3\/workflow_steps\/5055527b-4fc0-4d5e-9408-560fb94b448c",
            "label": null,
            "isExecuted": false,
            "uuid": "6952463a-f304-4ba3-9155-4b5194417138"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Assets -> Create Assets",
            "targetStep": "\/api\/3\/workflow_steps\/5055527b-4fc0-4d5e-9408-560fb94b448c",
            "sourceStep": "\/api\/3\/workflow_steps\/a5724d01-3d07-4342-944b-21893822e0d7",
            "label": null,
            "isExecuted": false,
            "uuid": "b252013a-e7f6-4a48-b017-f48a1b920ccc"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "3b864d85-da2f-416a-ac06-27bb0b8379cd",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Alerts",
        "Assets",
        "Nozomi",
        "Referenced"
    ]
}