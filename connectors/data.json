[
    {
        "name": "nozomi-networks-central-management-console",
        "label": "Nozomi Networks Central Management Console",
        "category": "OT & IoT Security",
        "description": "The Nozomi Networks Central Management Console (CMC) consolidates OT and IoT risk monitoring and visibility from Guardian physical or virtual appliances across all of your distributed sites. It integrates with your IT security infrastructure for streamlined workflows and faster response to threats and anomalies.",
        "publisher": null,
        "operation_roles": [],
        "configurations": [
            {
                "id": 5,
                "config_id": "b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                "status": 1,
                "name": "A1",
                "default": true,
                "config": {
                    "password": "iZG2I9lPS7SkadypnlVwb9NDy0yBhnAcU4dB3gRZ5IZNI3dmcn23@KlS2#!ck",
                    "username": "admin",
                    "server_url": "https:\/\/10.132.254.14\/",
                    "verify_ssl": false
                },
                "remote_status": [],
                "health_status": [],
                "connector": 42,
                "agent": "00f27162ae627f37127d3c497cf6862f",
                "teams": []
            }
        ],
        "dataImports": [
            {
                "id": 2,
                "name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                "description": "Metadata for Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                "status": null,
                "created_by": "3451141c-bac6-467c-8d72-85e0fab569ce",
                "modified_by": "3451141c-bac6-467c-8d72-85e0fab569ce",
                "owners": [],
                "data_mapping": [],
                "playbooks": [],
                "created_at": "2023-02-27T09:32:06.135814Z",
                "modified_at": "2023-03-02T07:43:59.947756Z",
                "metadata": {
                    "scheduleId": "gAAAAABkAFO_MLuy0UGV9l2cSRbFzILzgP47DqBmlNkx2jSQValjBG2QePRh2ejuVxPcVn2M_u9EqSNlHq4kb4q1OOnW1v6QCQ==",
                    "scheduleName": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                    "scheduleStatus": false
                },
                "previous_config_id": null,
                "configuration": "b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                "schedule": {
                    "id": "gAAAAABkAdAS6qNgpY-MZAa3un2q0OPD9cnkaSALtQ9PM-_wA-OmRcs-ykpIwpcAVgHxPJ9-ENjYoCSB-5ZW4Zw9NCCW7ZCY3g==",
                    "crontab": {
                        "id": 11,
                        "minute": "01",
                        "hour": "0",
                        "day_of_week": "*",
                        "day_of_month": "*",
                        "month_of_year": "*",
                        "timezone": "UTC"
                    },
                    "interval": null,
                    "name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                    "task": "workflow.tasks.periodic_task",
                    "args": "[]",
                    "kwargs": {
                        "exit_if_running": false,
                        "wf_iri": "\/api\/3\/workflows\/5229d603-0e65-49f2-8606-23f2c401b0e2",
                        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                        "name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                        "description": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                        "auth": {
                            "auth_method": "CS HMAC"
                        },
                        "referenceid": null,
                        "schedule_entry_name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                        "schedule_id": "1eac0aab-4755-4d9e-94b7-2365b6ed5208"
                    },
                    "queue": null,
                    "exchange": null,
                    "routing_key": null,
                    "headers": "{}",
                    "priority": 3,
                    "expires": null,
                    "expire_seconds": null,
                    "one_off": false,
                    "start_time": null,
                    "enabled": false,
                    "last_run_at": null,
                    "total_run_count": 0,
                    "date_changed": "2023-03-02T07:43:59.753931Z",
                    "description": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                    "solar": null,
                    "clocked": null
                }
            }
        ],
        "install_mode": "rpm",
        "ingestionPlaybooks": {
            "collections": [
                {
                    "@context": "\/api\/3\/contexts\/WorkflowCollection",
                    "@type": "WorkflowCollection",
                    "name": "Nozomi Networks Central Management Console 1.0.0 A1Ingestion(b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33)",
                    "description": null,
                    "visible": false,
                    "workflows": [
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "> Nozomi Networks Central Management Console > Fetch Alerts",
                            "aliasName": null,
                            "tag": "#Nozomi Networks Central Management Console",
                            "description": "Fetches all alerts from Nozomi Networks Central Management Console.",
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/86676428-fc6b-41a5-94b7-ef4712876c6b",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Fetch All Alerts",
                                    "description": null,
                                    "arguments": {
                                        "name": "Nozomi Networks Central Management Console",
                                        "config": "b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                                        "params": {
                                            "query": "",
                                            "start_time": "{{vars.last_pull_time}}",
                                            "appliance_ids": "{{vars.appliance_ids}}"
                                        },
                                        "version": "1.0.0",
                                        "connector": "nozomi-networks-central-management-console",
                                        "operation": "fetch_alerts",
                                        "operationTitle": "Fetch All Alerts",
                                        "pickFromTenant": false,
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "580",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
                                    "group": null,
                                    "uuid": "01163a2c-3bc6-475a-86c7-6ad516259104"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Set Time Configuration",
                                    "description": null,
                                    "arguments": {
                                        "curr_timestamp": "{{arrow.get( arrow.utcnow().int_timestamp).strftime('%Y-%m-%dT%H:%M:%S.%fZ')}}",
                                        "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) < 1%}{{arrow.utcnow().shift(minutes=-vars.Pull_Sample_Events_in_Past_X_Minutes).format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}"
                                    },
                                    "status": null,
                                    "top": "440",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "2bf05764-16de-4829-a99b-fe988503a573"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Save Result",
                                    "description": null,
                                    "arguments": {
                                        "data": "{{vars.steps.Fetch_All_Alerts.data.get(\"result\", [])}}",
                                        "macro_name": "{{vars.NozomiNetworksCMCLastAlertPullTime}}",
                                        "curr_timestamp": "{{vars.curr_timestamp}}"
                                    },
                                    "status": null,
                                    "top": "720",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "5d142d14-6c0e-42be-b98d-ff379eed7a46"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            },
                                            "_configuration_schema": "[\n{\n    \"title\": \"Pull Threats from Last X Minutes\",\n    \"name\": \"Pull_Sample_Events_in_Past_X_Minutes\",\n    \"type\": \"text\",\n    \"tooltip\": \"Fetch threats from last X minutes. e.g 5\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 10\n  },\n{\n        \"title\": \"Appliance IDs\",\n        \"name\": \"appliance_ids\",\n          \"type\": \"text\",\n          \"visible\": true,\n          \"editable\": true,\n          \"required\": false,\n          \"placeholder\": \"\",\n          \"tooltip\": \"Appliance ID\/Comma separated Appliance IDs using which you want to retrieve alerts.\"\n        }\n]",
                                            "NozomiNetworksCMCLastAlertPullTime": "NozomiNetworksCMCLastAlertPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('\/')[-1].replace('-','_')}}"
                                        }
                                    },
                                    "status": null,
                                    "top": "20",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "86676428-fc6b-41a5-94b7-ef4712876c6b"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "appliance_ids": "",
                                        "Pull_Sample_Events_in_Past_X_Minutes": "1000000"
                                    },
                                    "status": null,
                                    "top": "160",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "e238b164-a2b8-4b52-95fc-c5a0407643d2"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Get Macro Value",
                                    "description": null,
                                    "arguments": {
                                        "params": {
                                            "iri": "\/api\/wf\/api\/dynamic-variable\/?format=json&name={{vars.NozomiNetworksCMCLastAlertPullTime}}",
                                            "body": "",
                                            "method": "GET"
                                        },
                                        "version": "3.2.3",
                                        "connector": "cyops_utilities",
                                        "operation": "make_cyops_request",
                                        "operationTitle": "FSR: Make FortiSOAR API Call",
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                                    "group": null,
                                    "uuid": "fd4accae-26eb-4939-96cf-9a7c59266669"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Set Time Configuration -> _dweda",
                                    "targetStep": "\/api\/3\/workflow_steps\/01163a2c-3bc6-475a-86c7-6ad516259104",
                                    "sourceStep": "\/api\/3\/workflow_steps\/2bf05764-16de-4829-a99b-fe988503a573",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "9cf554bc-5099-4dc6-8ea5-e4bd6e5552cc"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "_dweda -> Save Result",
                                    "targetStep": "\/api\/3\/workflow_steps\/5d142d14-6c0e-42be-b98d-ff379eed7a46",
                                    "sourceStep": "\/api\/3\/workflow_steps\/01163a2c-3bc6-475a-86c7-6ad516259104",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "8f600536-b629-4e21-bceb-dfa935597712"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/e238b164-a2b8-4b52-95fc-c5a0407643d2",
                                    "sourceStep": "\/api\/3\/workflow_steps\/86676428-fc6b-41a5-94b7-ef4712876c6b",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "c8d4dbdf-62b2-45fc-b8b9-46dfc1dd9cc3"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Get Macro Value",
                                    "targetStep": "\/api\/3\/workflow_steps\/fd4accae-26eb-4939-96cf-9a7c59266669",
                                    "sourceStep": "\/api\/3\/workflow_steps\/e238b164-a2b8-4b52-95fc-c5a0407643d2",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "c4a152fe-8a8d-47f8-992c-ac4a1e846fbd"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Get Macro Value -> Set Time Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/2bf05764-16de-4829-a99b-fe988503a573",
                                    "sourceStep": "\/api\/3\/workflow_steps\/fd4accae-26eb-4939-96cf-9a7c59266669",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "6f4ee4cf-d3dd-4b98-96ff-f6dc64060a76"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "d67b4697-0f95-4560-a28e-eca6b4f65d9c",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "fetch",
                                "nozomi-networks-central-management-console",
                                "Nozomi"
                            ]
                        },
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "Nozomi Networks Central Management Console > Create Alerts",
                            "aliasName": null,
                            "tag": "#Nozomi Networks Central Management Console",
                            "description": "Create records on FortiSOAR",
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [
                                "Incidents With IRI",
                                "Alert"
                            ],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/2f32cb65-eb82-4ede-a7a2-78885afeb37b",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Record",
                                    "description": null,
                                    "arguments": {
                                        "resource": {
                                            "name": "{{vars.alert.name}}",
                                            "type": {
                                                "id": 210,
                                                "@id": "\/api\/3\/picklists\/574a6ee2-7265-4701-815e-cff83b053bce",
                                                "icon": null,
                                                "uuid": "574a6ee2-7265-4701-815e-cff83b053bce",
                                                "@type": "Picklist",
                                                "color": null,
                                                "display": "Other \/ Unknown",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/a7087b9c-5660-495f-a8ac-c3b198ddb8c2",
                                                "itemValue": "Other \/ Unknown",
                                                "importedBy": [],
                                                "orderIndex": 19
                                            },
                                            "state": {
                                                "id": 181,
                                                "@id": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                                                "icon": null,
                                                "uuid": "a1bac09b-1441-45aa-ad1b-c88744e48e72",
                                                "@type": "Picklist",
                                                "color": null,
                                                "display": "New",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/2f9ed741-25fe-475a-9f12-64336288eebf",
                                                "itemValue": "New",
                                                "importedBy": [],
                                                "orderIndex": 0
                                            },
                                            "source": "Nozomi Networks Central Management Console",
                                            "status": "{{vars.alert[\"status\"] | resolveRange(vars.alerts_status_map)}}",
                                            "filePath": "{{vars.alert.capture_device}}",
                                            "severity": "{{vars.alert[\"severity\"] | resolveRange(vars.alerts_severity_map)}}",
                                            "sourceId": "{{vars.alert.id}}",
                                            "sourceIp": "{{vars.alert.ip_src}}",
                                            "__replace": "true",
                                            "epochTime": "{{vars.alert.time}}",
                                            "eventTime": "{{arrow.get(vars.alert.created_time).to(\"UTC\").format(\"YYYY-MM-DDTHH:mm:ss\")+'Z'}}",
                                            "recordTags": [
                                                "\/api\/3\/tags\/Alerts"
                                            ],
                                            "sourcePort": "{%if vars.alert.port_src%}{{vars.alert.port_src}}{%endif%}",
                                            "sourcedata": "{{vars.alert | toJSON}}",
                                            "description": "<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Fields<\/th><th width=\\\"250\\\">Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Description<\/td>\n<td>{{vars.alert.description}}<\/td><\/tr>\n<td>Risk<\/td>\n<td>{{vars.alert.risk}}<\/td><\/tr>\n<td>Type ID<\/td>\n<td>{{vars.alert.type_id}}<\/td><\/tr>\n<td>Protocol<\/td>\n<td>{{vars.alert.protocol}}<\/td><\/tr>\n<td>Transport Protocol<\/td>\n<td>{{vars.alert.transport_protocol}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Source Fields<\/th><th width=\\\"250\\\">Source Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Source ID<\/td>\n<td>{{vars.alert.id_src}}<\/td><\/tr>\n<td>MAC Source Address<\/td>\n<td>{{vars.alert.mac_src}}<\/td><\/tr>\n<td>Source Roles<\/td>\n<td>{{vars.alert.src_roles}}<\/td><\/tr>\n<td>Source Types<\/td>\n<td>{{vars.alert.types_src}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Destination Fields<\/th><th width=\\\"250\\\">Destination Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Destination ID<\/td>\n<td>{{vars.alert.id_dst}}<\/td><\/tr>\n<td>MAC Destination Address<\/td>\n<td>{{vars.alert.mac_dst}}<\/td><\/tr>\n<td>Destination Roles<\/td>\n<td>{{vars.alert.dst_roles}}<\/td><\/tr>\n<td>Destination Types<\/td>\n<td>{{vars.alert.types_dst}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<\/table>",
                                            "targetAsset": "{{vars.alert.label_dst}}",
                                            "ackSlaStatus": {
                                                "id": 356,
                                                "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                                "icon": null,
                                                "uuid": "72979f64-e8b9-4888-a965-957e0ec24818",
                                                "@type": "Picklist",
                                                "color": "#808080",
                                                "display": "Awaiting Action",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                                                "itemValue": "Awaiting Action",
                                                "importedBy": [],
                                                "orderIndex": 2
                                            },
                                            "destinationIp": "{{vars.alert.ip_dst}}",
                                            "mitreattackid": "{{vars.alert.mitre_attack_techniques}}",
                                            "respSlaStatus": {
                                                "id": 356,
                                                "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                                "icon": null,
                                                "uuid": "72979f64-e8b9-4888-a965-957e0ec24818",
                                                "@type": "Picklist",
                                                "color": "#808080",
                                                "display": "Awaiting Action",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                                                "itemValue": "Awaiting Action",
                                                "importedBy": [],
                                                "orderIndex": 2
                                            },
                                            "priorityWeight": 1,
                                            "destinationPort": "{%if vars.alert.port_dst%}{{vars.alert.port_dst}}{%endif%}",
                                            "escalatedtoincident": {
                                                "id": 268,
                                                "@id": "\/api\/3\/picklists\/2128a09c-153d-4db3-985d-de6be33deae5",
                                                "icon": null,
                                                "uuid": "2128a09c-153d-4db3-985d-de6be33deae5",
                                                "@type": "Picklist",
                                                "color": "#808080",
                                                "display": "No",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/e131cc54-9ae4-43c9-b830-af6e331fe024",
                                                "itemValue": "No",
                                                "importedBy": [],
                                                "orderIndex": 1
                                            },
                                            "alertRemainingAckSLA": 0
                                        },
                                        "_showJson": false,
                                        "operation": "Append",
                                        "collection": "\/api\/3\/upsert\/alerts",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "435",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "2e9307a0-fd86-47ad-980d-f0815448db06"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            }
                                        }
                                    },
                                    "status": null,
                                    "top": "30",
                                    "left": "300",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "2f32cb65-eb82-4ede-a7a2-78885afeb37b"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Correlated Alerts",
                                    "description": null,
                                    "arguments": {
                                        "resource": {
                                            "name": "{{vars.alert.name}}",
                                            "type": "\/api\/3\/picklists\/574a6ee2-7265-4701-815e-cff83b053bce",
                                            "state": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                                            "__link": {
                                                "incidents": "{{vars.incIRIList}}"
                                            },
                                            "source": "Nozomi Networks Central Management Console",
                                            "status": "{{vars.alert[\"status\"] | resolveRange(vars.alerts_status_map)}}",
                                            "filePath": "{{vars.alert.capture_device}}",
                                            "severity": "{{vars.alert[\"severity\"] | resolveRange(vars.alerts_severity_map)}}",
                                            "sourceId": "{{vars.alert.id}}",
                                            "sourceIp": "{{vars.alert.ip_src}}",
                                            "__replace": "true",
                                            "epochTime": "{{vars.alert.time}}",
                                            "eventTime": "{{arrow.get(vars.alert.created_time).to(\"UTC\").format(\"YYYY-MM-DDTHH:mm:ss\")+'Z'}}",
                                            "recordTags": [
                                                "\/api\/3\/tags\/Alerts"
                                            ],
                                            "sourcePort": "{%if vars.alert.port_src%}{{vars.alert.port_src}}{%endif%}",
                                            "sourcedata": "{{vars.alert | toJSON}}",
                                            "description": "<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Fields<\/th><th width=\\\"250\\\">Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Description<\/td>\n<td>{{vars.alert.description}}<\/td><\/tr>\n<td>Risk<\/td>\n<td>{{vars.alert.risk}}<\/td><\/tr>\n<td>Type ID<\/td>\n<td>{{vars.alert.type_id}}<\/td><\/tr>\n<td>Protocol<\/td>\n<td>{{vars.alert.protocol}}<\/td><\/tr>\n<td>Transport Protocol<\/td>\n<td>{{vars.alert.transport_protocol}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Source Fields<\/th><th width=\\\"250\\\">Source Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Source ID<\/td>\n<td>{{vars.alert.id_src}}<\/td><\/tr>\n<td>MAC Source Address<\/td>\n<td>{{vars.alert.mac_src}}<\/td><\/tr>\n<td>Source Roles<\/td>\n<td>{{vars.alert.src_roles}}<\/td><\/tr>\n<td>Source Types<\/td>\n<td>{{vars.alert.types_src}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Destination Fields<\/th><th width=\\\"250\\\">Destination Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Destination ID<\/td>\n<td>{{vars.alert.id_dst}}<\/td><\/tr>\n<td>MAC Destination Address<\/td>\n<td>{{vars.alert.mac_dst}}<\/td><\/tr>\n<td>Destination Roles<\/td>\n<td>{{vars.alert.dst_roles}}<\/td><\/tr>\n<td>Destination Types<\/td>\n<td>{{vars.alert.types_dst}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<\/table>",
                                            "targetAsset": "{{vars.alert.label_dst}}",
                                            "ackSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "destinationIp": "{{vars.alert.ip_dst}}",
                                            "mitreattackid": "{{vars.alert.mitre_attack_techniques}}",
                                            "respSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "priorityWeight": 1,
                                            "destinationPort": "{%if vars.alert.port_dst%}{{vars.alert.port_dst}}{%endif%}",
                                            "escalatedtoincident": "\/api\/3\/picklists\/fa12313b-66af-4a2e-864e-a5f19241b734",
                                            "alertRemainingAckSLA": 0
                                        },
                                        "_showJson": false,
                                        "operation": "Append",
                                        "collection": "\/api\/3\/upsert\/alerts",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": {
                                            "alert": "{{vars.steps.Create_Correlated_Alerts}}"
                                        }
                                    },
                                    "status": null,
                                    "top": "570",
                                    "left": "475",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "39d2639a-54aa-44b6-a8c3-abd81f4cc27e"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Add Comment In Incident",
                                    "description": null,
                                    "arguments": {
                                        "resource": {
                                            "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                                            "people": [],
                                            "content": "<p>Alert <a href=\"{{vars.request.baseUri}}\/modules\/alerts\/{{vars.alert.uuid}}\" target=\"_blank\" rel=\"noopener\">{{vars.alert.name}}<\/a> got correlated.<\/p>",
                                            "__replace": "",
                                            "incidents": "{{vars.incIRIList}}",
                                            "isImportant": false,
                                            "peopleUpdated": false
                                        },
                                        "operation": "Overwrite",
                                        "collection": "\/api\/3\/comments",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "705",
                                    "left": "475",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "3c219781-141a-44d5-a1cc-f444c591ac73"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Check alert with parents",
                                    "description": null,
                                    "arguments": {
                                        "conditions": [
                                            {
                                                "option": "No",
                                                "step_iri": "\/api\/3\/workflow_steps\/2e9307a0-fd86-47ad-980d-f0815448db06",
                                                "condition": "{{ vars.alert.parents == [] }}",
                                                "step_name": "Create Record"
                                            },
                                            {
                                                "option": "Yes",
                                                "step_iri": "\/api\/3\/workflow_steps\/af742933-6187-4d25-8c39-08b0b062f2cd",
                                                "condition": "{{ vars.alert.parents != [] }}",
                                                "step_name": "Find Incidents in Alerts"
                                            }
                                        ]
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "300",
                                    "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
                                    "group": null,
                                    "uuid": "48d1fa57-ef6a-4a5b-86fb-e5eff2e681cd"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "alert": "{{vars.input.params.Alert}}",
                                        "incIRIList": "[]",
                                        "alerts_type_map": "{}",
                                        "alerts_state_map": "{}",
                                        "alerts_status_map": "{'open': {{'AlertStatus'| picklist('Open') }}, 'ack': {{'AlertStatus'| picklist('Investigating') }}, 'closed': {{'AlertStatus'| picklist('Closed') }}}",
                                        "incident_with_iri": "{{vars.input.params['Incidents With IRI']}}",
                                        "alerts_severity_map": "{'0..2': {{'Severity'| picklist('Minimal') }}, '3..4': {{'Severity'| picklist('Low') }}, '5..7': {{'Severity'| picklist('Medium') }}, '8..9': {{'Severity'| picklist('High') }}, '9..10': {{'Severity'| picklist('Critical') }}}",
                                        "alerts_ackSlaStatus_map": "{}",
                                        "alerts_respSlaStatus_map": "{}",
                                        "alerts_escalatedtoincident_map": "{}"
                                    },
                                    "status": null,
                                    "top": "160",
                                    "left": "300",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "831255e4-91d8-40d3-aa35-0bc26d4780a6"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Find Incidents in Alerts",
                                    "description": null,
                                    "arguments": {
                                        "incident": "{% for item in vars.alert.parents %}{{vars.incIRIList.append(vars.incident_with_iri.get(item))}}{% endfor %}"
                                    },
                                    "status": null,
                                    "top": "440",
                                    "left": "480",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "af742933-6187-4d25-8c39-08b0b062f2cd"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Check alert with parents",
                                    "targetStep": "\/api\/3\/workflow_steps\/48d1fa57-ef6a-4a5b-86fb-e5eff2e681cd",
                                    "sourceStep": "\/api\/3\/workflow_steps\/831255e4-91d8-40d3-aa35-0bc26d4780a6",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "16967829-6b43-4551-bd4b-15e7a2c4f9e7"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/831255e4-91d8-40d3-aa35-0bc26d4780a6",
                                    "sourceStep": "\/api\/3\/workflow_steps\/2f32cb65-eb82-4ede-a7a2-78885afeb37b",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "46b68b23-72bd-4f7d-ad19-ba89f0e0248c"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Check alert with parents -> Find Incidents in Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/af742933-6187-4d25-8c39-08b0b062f2cd",
                                    "sourceStep": "\/api\/3\/workflow_steps\/48d1fa57-ef6a-4a5b-86fb-e5eff2e681cd",
                                    "label": "Yes",
                                    "isExecuted": false,
                                    "uuid": "f5487b7f-8d18-4cb4-bbfb-c836c77053e1"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Create Correlated Alerts -> Add Comment In Incident",
                                    "targetStep": "\/api\/3\/workflow_steps\/3c219781-141a-44d5-a1cc-f444c591ac73",
                                    "sourceStep": "\/api\/3\/workflow_steps\/39d2639a-54aa-44b6-a8c3-abd81f4cc27e",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "66602ce4-e8c5-4af1-96f6-9f7ea820b0db"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Check alert with parents -> Create Record",
                                    "targetStep": "\/api\/3\/workflow_steps\/2e9307a0-fd86-47ad-980d-f0815448db06",
                                    "sourceStep": "\/api\/3\/workflow_steps\/48d1fa57-ef6a-4a5b-86fb-e5eff2e681cd",
                                    "label": "No",
                                    "isExecuted": false,
                                    "uuid": "f93a09d8-9a6b-4b0b-8ab5-c95815582259"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Find Incidents in Alerts -> Create Correlated Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/39d2639a-54aa-44b6-a8c3-abd81f4cc27e",
                                    "sourceStep": "\/api\/3\/workflow_steps\/af742933-6187-4d25-8c39-08b0b062f2cd",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "5c5cf22f-f760-470d-a511-edf1bcc209a2"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "b167f1eb-6eea-4e19-a621-9c410b38b45e",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "create",
                                "nozomi-networks-central-management-console",
                                "Nozomi"
                            ]
                        },
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "Nozomi Networks Central Management Console > Ingest",
                            "aliasName": null,
                            "tag": "#Nozomi Networks Central Management Console",
                            "description": "This playbook demonstrate the list alerts operation.",
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/0306f90f-5d42-4780-a465-345d98043591",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            }
                                        }
                                    },
                                    "status": null,
                                    "top": "30",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "0306f90f-5d42-4780-a465-345d98043591"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Fetch Alerts",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.steps.List_Alerts.data | json_query('[?is_incident == `false`]')}}",
                                            "__bulk": false,
                                            "parallel": true,
                                            "condition": ""
                                        },
                                        "arguments": {
                                            "Alert": "{{vars.item}}",
                                            "Incidents With IRI": "{{vars.incident}}"
                                        },
                                        "apply_async": true,
                                        "step_variables": [],
                                        "pass_parent_env": false,
                                        "pass_input_record": false,
                                        "workflowReference": "\/api\/3\/workflows\/b167f1eb-6eea-4e19-a621-9c410b38b45e"
                                    },
                                    "status": null,
                                    "top": "705",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                                    "group": null,
                                    "uuid": "144aacc6-c0f0-4137-b6bb-7c4a10543f75"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "List Alerts",
                                    "description": null,
                                    "arguments": {
                                        "arguments": [],
                                        "apply_async": false,
                                        "step_variables": [],
                                        "pass_parent_env": false,
                                        "pass_input_record": false,
                                        "workflowReference": "\/api\/3\/workflows\/d67b4697-0f95-4560-a28e-eca6b4f65d9c"
                                    },
                                    "status": null,
                                    "top": "165",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                                    "group": null,
                                    "uuid": "1fb37c9f-ec02-480b-bd6f-6c2abf74ca41"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Update Last Alert Pull Time",
                                    "description": null,
                                    "arguments": {
                                        "params": {
                                            "macro": "{{vars.steps.List_Alerts.macro_name}}",
                                            "value": "{{vars.steps.List_Alerts.curr_timestamp}}"
                                        },
                                        "version": "3.2.3",
                                        "connector": "cyops_utilities",
                                        "operation": "updatemacro",
                                        "operationTitle": "FSR: Create\/Update Global Variables",
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "840",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                                    "group": null,
                                    "uuid": "3b224876-4145-4d97-92ca-e9e8d9342e13"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Find Incident IRI",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.steps.Create_Record | json_query('[].[sourceId, \"@id\"]')}}",
                                            "parallel": false,
                                            "condition": ""
                                        },
                                        "incident_iri": "{{vars.incident.update({vars.item[0]:vars.item[1]})}}"
                                    },
                                    "status": null,
                                    "top": "570",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "6a57a94e-5aef-45f0-a070-81aefc65bfa0"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Record",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.steps.List_Alerts.data | json_query('[?is_incident == `true`]')}}",
                                            "__bulk": true,
                                            "parallel": false,
                                            "condition": "",
                                            "batch_size": 100
                                        },
                                        "resource": {
                                            "name": "{{vars.item.name}}",
                                            "phase": "\/api\/3\/picklists\/bb740542-f699-11e7-8c3f-9a214cf093ae",
                                            "resSla": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "source": "Nozomi Networks Central Management Console",
                                            "status": "{{vars.item[\"status\"] | resolveRange(vars.alerts_status_map)}}",
                                            "category": "\/api\/3\/picklists\/703218fc-f69a-11e7-8c3f-9a214cf093ae",
                                            "severity": "{{vars.item[\"severity\"] | resolveRange(vars.alerts_severity_map)}}",
                                            "slaState": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "sourceId": "{{vars.item.id}}",
                                            "__replace": "true",
                                            "recordTags": [
                                                "\/api\/3\/tags\/Incidents"
                                            ],
                                            "sourcedata": "{{vars.item | toJSON}}",
                                            "description": "<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Fields<\/th><th width=\\\"250\\\">Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Description<\/td>\n<td>{{vars.item.description}}<\/td><\/tr>\n<td>Risk<\/td>\n<td>{{vars.item.risk}}<\/td><\/tr>\n<td>Type ID<\/td>\n<td>{{vars.item.type_id}}<\/td><\/tr>\n<td>Protocol<\/td>\n<td>{{vars.item.protocol}}<\/td><\/tr>\n<td>Transport Protocol<\/td>\n<td>{{vars.item.transport_protocol}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Source Fields<\/th><th width=\\\"250\\\">Source Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Source ID<\/td>\n<td>{{vars.item.id_src}}<\/td><\/tr>\n<td>Source IP<\/td>\n<td>{{vars.item.ip_src}}<\/td><\/tr>\n<td>Source Port<\/td>\n<td>{{vars.item.port_src}}<\/td><\/tr>\n<td>MAC Source Address<\/td>\n<td>{{vars.item.mac_src}}<\/td><\/tr>\n<td>Source Roles<\/td>\n<td>{{vars.item.src_roles}}<\/td><\/tr>\n<td>Source Types<\/td>\n<td>{{vars.item.types_src}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Destination Fields<\/th><th width=\\\"250\\\">Destination Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Destination ID<\/td>\n<td>{{vars.item.id_dst}}<\/td><\/tr>\n<td>Destination IP<\/td>\n<td>{{vars.item.ip_dst}}<\/td><\/tr>\n<td>Destination Port<\/td>\n<td>{{vars.item.port_dst}}<\/td><\/tr>\n<td>MAC Destination Address<\/td>\n<td>{{vars.item.mac_dst}}<\/td><\/tr>\n<td>Destination Roles<\/td>\n<td>{{vars.item.dst_roles}}<\/td><\/tr>\n<td>Destination Types<\/td>\n<td>{{vars.item.types_dst}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<\/table>",
                                            "mitreattackid": "{{vars.item.mitre_attack_techniques}}",
                                            "slaPercentage": 0
                                        },
                                        "operation": "Overwrite",
                                        "collection": "\/api\/3\/upsert\/incidents",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "440",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "bd5a5bc8-8cac-49d8-9992-553c2a624cf1"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "temp": "{{vars.steps.List_Alerts.data | json_query('[?is_incident == `true`]')}}",
                                        "incident": "{}",
                                        "alerts_status_map": "{'open': {{\"AlertStatus\"| picklist(\"Open\")}},'ack': {{\"AlertStatus\"| picklist(\"Investigating\")}}, 'closed': {{\"AlertStatus\"| picklist(\"Closed\")}}}",
                                        "alerts_severity_map": "{'0..2': {{'Severity'| picklist('Minimal') }}, '3..4': {{'Severity'| picklist('Low') }}, '5..7': {{'Severity'| picklist('Medium') }}, '8..9': {{'Severity'| picklist('High') }}, '9..10': {{'Severity'| picklist('Critical') }}}"
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "120",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "ce342f58-dce5-42c3-b5a0-e9c0aaee5a56"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Create Record",
                                    "targetStep": "\/api\/3\/workflow_steps\/bd5a5bc8-8cac-49d8-9992-553c2a624cf1",
                                    "sourceStep": "\/api\/3\/workflow_steps\/ce342f58-dce5-42c3-b5a0-e9c0aaee5a56",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "2e3e1ea1-c650-4970-a212-3ba0472b5073"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "List Alerts -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/ce342f58-dce5-42c3-b5a0-e9c0aaee5a56",
                                    "sourceStep": "\/api\/3\/workflow_steps\/1fb37c9f-ec02-480b-bd6f-6c2abf74ca41",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "30ea162b-80c0-4321-b9c5-55f727c0b4c5"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Create Record -> Find Incident IRI",
                                    "targetStep": "\/api\/3\/workflow_steps\/6a57a94e-5aef-45f0-a070-81aefc65bfa0",
                                    "sourceStep": "\/api\/3\/workflow_steps\/bd5a5bc8-8cac-49d8-9992-553c2a624cf1",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "758d6a84-742b-44f0-8a1c-5b71622276b0"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Create Record1 -> Update Last Alert Pull Time",
                                    "targetStep": "\/api\/3\/workflow_steps\/3b224876-4145-4d97-92ca-e9e8d9342e13",
                                    "sourceStep": "\/api\/3\/workflow_steps\/144aacc6-c0f0-4137-b6bb-7c4a10543f75",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "8128308c-ebac-4908-a89c-58f06b0cfbce"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> List Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/1fb37c9f-ec02-480b-bd6f-6c2abf74ca41",
                                    "sourceStep": "\/api\/3\/workflow_steps\/0306f90f-5d42-4780-a465-345d98043591",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "93fbc508-0db9-4b75-a637-e80485c132b2"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Find Incident IRI -> Fetch Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/144aacc6-c0f0-4137-b6bb-7c4a10543f75",
                                    "sourceStep": "\/api\/3\/workflow_steps\/6a57a94e-5aef-45f0-a070-81aefc65bfa0",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "d303b83a-6945-40fc-bd15-05799eff3a4a"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "5229d603-0e65-49f2-8606-23f2c401b0e2",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "create",
                                "ingest",
                                "nozomi-networks-central-management-console",
                                "Nozomi"
                            ],
                            "schedules": [
                                {
                                    "id": "gAAAAABkAdARivl7RYE60sMKqyUPKyqe8L0omRW21Ss2wmJHehY4Rd4a9XUwUqkzVGWGetdKCLHiTGWrcV2BEwF7O6wD1QHVfg==",
                                    "crontab": {
                                        "id": 11,
                                        "minute": "01",
                                        "hour": "0",
                                        "day_of_week": "*",
                                        "day_of_month": "*",
                                        "month_of_year": "*",
                                        "timezone": "UTC"
                                    },
                                    "interval": null,
                                    "name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                                    "task": "workflow.tasks.periodic_task",
                                    "args": "[]",
                                    "kwargs": {
                                        "exit_if_running": false,
                                        "wf_iri": "\/api\/3\/workflows\/5229d603-0e65-49f2-8606-23f2c401b0e2",
                                        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                        "name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                                        "description": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                                        "auth": {
                                            "auth_method": "CS HMAC"
                                        },
                                        "referenceid": null,
                                        "schedule_entry_name": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                                        "schedule_id": "1eac0aab-4755-4d9e-94b7-2365b6ed5208"
                                    },
                                    "queue": null,
                                    "exchange": null,
                                    "routing_key": null,
                                    "headers": "{}",
                                    "priority": 3,
                                    "expires": null,
                                    "expire_seconds": null,
                                    "one_off": false,
                                    "start_time": null,
                                    "enabled": false,
                                    "last_run_at": null,
                                    "total_run_count": 0,
                                    "date_changed": "2023-03-02T07:43:59.753931Z",
                                    "description": "Ingestion_nozomi-networks-central-management-console_A1_b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                                    "solar": null,
                                    "clocked": null
                                }
                            ]
                        }
                    ],
                    "image": null,
                    "uuid": "b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                    "deletedAt": null,
                    "recordTags": []
                }
            ],
            "exported_tags": [
                "dataingestion",
                "fetch",
                "nozomi-networks-central-management-console",
                "Nozomi",
                "create",
                "ingest"
            ],
            "globalVariables": []
        }
    },
    {
        "name": "nozomi-networks-guardian",
        "label": "Nozomi Networks Guardian",
        "category": "OT & IoT Security",
        "description": "The Nozomi Networks Guardian platform used to monitor OT\/IoT\/IT networks. It combines asset discovery, network visualization, vulnerability assessment, risk monitoring and threat detection in a single solution. This integration is used to gather alerts and assets information from Nozomi.",
        "publisher": null,
        "operation_roles": [],
        "configurations": [
            {
                "id": 4,
                "config_id": "3301581d-6006-4824-bbbc-c5473f82b67c",
                "status": 1,
                "name": "A1",
                "default": true,
                "config": {
                    "password": "eXJUUubgPgUNODtAbqFCL6V91A2p9ZK705klRQoXYk1xBg==I3dmcn23@KlS2#!ck",
                    "username": "admin",
                    "server_url": "https:\/\/10.132.254.15",
                    "verify_ssl": false
                },
                "remote_status": [],
                "health_status": [],
                "connector": 41,
                "agent": "00f27162ae627f37127d3c497cf6862f",
                "teams": []
            }
        ],
        "dataImports": [
            {
                "id": 1,
                "name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                "description": "Metadata for Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                "status": null,
                "created_by": "3451141c-bac6-467c-8d72-85e0fab569ce",
                "modified_by": "3451141c-bac6-467c-8d72-85e0fab569ce",
                "owners": [],
                "data_mapping": [],
                "playbooks": [],
                "created_at": "2023-02-27T08:43:58.766353Z",
                "modified_at": "2023-02-28T09:25:10.408904Z",
                "metadata": {
                    "scheduleId": "gAAAAABj_ch2Qqn7-OFLJA6NoYBDqAoJLltjZALkZrfkwJ-Iu87kfTxZ9Ck5BsTjdEZYRdsptp528NFlOy2VWytCJL2nwXVJDA==",
                    "scheduleName": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                    "scheduleStatus": false
                },
                "previous_config_id": null,
                "configuration": "3301581d-6006-4824-bbbc-c5473f82b67c",
                "schedule": {
                    "id": "gAAAAABkAdATa2ojZTXffavOlO83P1X8DJvVB67hiv-otG611rR3Kd7tkNq1MZl7Od3X6OqbtSKCQlLBc2PEiOcqhe90Uegg6g==",
                    "crontab": {
                        "id": 11,
                        "minute": "01",
                        "hour": "0",
                        "day_of_week": "*",
                        "day_of_month": "*",
                        "month_of_year": "*",
                        "timezone": "UTC"
                    },
                    "interval": null,
                    "name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                    "task": "workflow.tasks.periodic_task",
                    "args": "[]",
                    "kwargs": {
                        "exit_if_running": false,
                        "wf_iri": "\/api\/3\/workflows\/bc5e0243-e1b7-46b0-a093-23633df653cd",
                        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                        "name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                        "description": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                        "auth": {
                            "auth_method": "CS HMAC"
                        },
                        "referenceid": null,
                        "schedule_entry_name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                        "schedule_id": "1c62d9e7-25ba-456c-8777-514ac0cdc62b"
                    },
                    "queue": null,
                    "exchange": null,
                    "routing_key": null,
                    "headers": "{}",
                    "priority": 3,
                    "expires": null,
                    "expire_seconds": null,
                    "one_off": false,
                    "start_time": null,
                    "enabled": false,
                    "last_run_at": null,
                    "total_run_count": 0,
                    "date_changed": "2023-02-28T09:25:10.159230Z",
                    "description": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                    "solar": null,
                    "clocked": null
                }
            }
        ],
        "install_mode": "rpm",
        "ingestionPlaybooks": {
            "collections": [
                {
                    "@context": "\/api\/3\/contexts\/WorkflowCollection",
                    "@type": "WorkflowCollection",
                    "name": "Nozomi Networks Guardian 1.1.0 A1Ingestion(3301581d-6006-4824-bbbc-c5473f82b67c)",
                    "description": null,
                    "visible": false,
                    "workflows": [
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "Nozomi Networks Guardian > Ingest",
                            "aliasName": null,
                            "tag": null,
                            "description": "This playbook demonstrate the list alerts operation.",
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/3301581d-6006-4824-bbbc-c5473f82b67c",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/38cfb1bc-6309-4448-8121-4f74148ed936",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Find Incident IRI",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.steps.Create_Record | json_query('[].[sourceId, \"@id\"]')}}",
                                            "parallel": false,
                                            "condition": ""
                                        },
                                        "incident_iri": "{{vars.incident.update({vars.item[0]:vars.item[1]})}}"
                                    },
                                    "status": null,
                                    "top": "570",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "257d8cd6-4005-4e40-9554-19dd3eadc702"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "route": "458e2460-158f-41dd-b0e9-ee45b8db5a44",
                                        "title": "Nozomi Networks Guardian > Ingest",
                                        "resources": [
                                            "incidents",
                                            "alerts"
                                        ],
                                        "inputVariables": [],
                                        "step_variables": {
                                            "input": {
                                                "params": [],
                                                "records": "{{vars.input.records}}"
                                            }
                                        },
                                        "executeButtonText": "Execute",
                                        "noRecordExecution": true,
                                        "singleRecordExecution": false
                                    },
                                    "status": null,
                                    "top": "30",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/f414d039-bb0d-4e59-9c39-a8f1e880b18a",
                                    "group": null,
                                    "uuid": "38cfb1bc-6309-4448-8121-4f74148ed936"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Update Last Alert Pull Time",
                                    "description": null,
                                    "arguments": {
                                        "params": {
                                            "macro": "{{vars.steps.List_Alerts.macro_name}}",
                                            "value": "{{vars.steps.List_Alerts.curr_timestamp}}"
                                        },
                                        "version": "3.2.2",
                                        "connector": "cyops_utilities",
                                        "operation": "updatemacro",
                                        "operationTitle": "FSR: Create\/Update Global Variables",
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "840",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                                    "group": null,
                                    "uuid": "8eb12b69-4fbe-4c83-ba6d-a93739e6e5a8"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "temp": "{{vars.steps.List_Alerts.data | json_query('[?is_incident == `true`]')}}",
                                        "incident": "{}",
                                        "alerts_status_map": "{'open': {{\"AlertStatus\"| picklist(\"Open\")}},'ack': {{\"AlertStatus\"| picklist(\"Investigating\")}}, 'closed': {{\"AlertStatus\"| picklist(\"Closed\")}}}",
                                        "alerts_severity_map": "{'0..2': {{'Severity'| picklist('Minimal') }}, '3..4': {{'Severity'| picklist('Low') }}, '5..7': {{'Severity'| picklist('Medium') }}, '8..9': {{'Severity'| picklist('High') }}, '9..10': {{'Severity'| picklist('Critical') }}}",
                                        "incidents_phase_map": "{}",
                                        "incidents_resSla_map": "{}",
                                        "incidents_status_map": "{}",
                                        "incidents_category_map": "{}",
                                        "incidents_severity_map": "{}",
                                        "incidents_slaState_map": "{}"
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "93e0d068-c794-4289-8f3f-7e66526fb646"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Record",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.steps.List_Alerts.data | json_query('[?is_incident == `true`]')}}",
                                            "__bulk": true,
                                            "parallel": false,
                                            "condition": "",
                                            "batch_size": 100
                                        },
                                        "resource": {
                                            "name": "{{vars.item.name}}",
                                            "phase": {
                                                "id": 272,
                                                "@id": "\/api\/3\/picklists\/bb740542-f699-11e7-8c3f-9a214cf093ae",
                                                "icon": null,
                                                "uuid": "bb740542-f699-11e7-8c3f-9a214cf093ae",
                                                "@type": "Picklist",
                                                "color": null,
                                                "display": "Detection",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/b862eb1f-b385-40ca-baa7-5a1b1f91a651",
                                                "itemValue": "Detection",
                                                "importedBy": [],
                                                "orderIndex": 0
                                            },
                                            "resSla": {
                                                "id": 356,
                                                "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                                "icon": null,
                                                "uuid": "72979f64-e8b9-4888-a965-957e0ec24818",
                                                "@type": "Picklist",
                                                "color": "#808080",
                                                "display": "Awaiting Action",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                                                "itemValue": "Awaiting Action",
                                                "importedBy": [],
                                                "orderIndex": 2
                                            },
                                            "source": "Nozomi Networks Guardian",
                                            "status": "{{vars.item[\"status\"] | resolveRange(vars.alerts_status_map)}}",
                                            "category": {
                                                "id": 292,
                                                "@id": "\/api\/3\/picklists\/703218fc-f69a-11e7-8c3f-9a214cf093ae",
                                                "icon": null,
                                                "uuid": "703218fc-f69a-11e7-8c3f-9a214cf093ae",
                                                "@type": "Picklist",
                                                "color": null,
                                                "display": "Malware",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/f3938848-6220-4b27-af2d-a5329cf63656",
                                                "itemValue": "Malware",
                                                "importedBy": [],
                                                "orderIndex": 8
                                            },
                                            "severity": "{{vars.item[\"severity\"] | resolveRange(vars.alerts_severity_map)}}",
                                            "slaState": {
                                                "id": 356,
                                                "@id": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                                "icon": null,
                                                "uuid": "72979f64-e8b9-4888-a965-957e0ec24818",
                                                "@type": "Picklist",
                                                "color": "#808080",
                                                "display": "Awaiting Action",
                                                "@context": "\/api\/3\/contexts\/Picklist",
                                                "listName": "\/api\/3\/picklist_names\/fe36a8f2-fcba-4221-b4ab-1081f596b153",
                                                "itemValue": "Awaiting Action",
                                                "importedBy": [],
                                                "orderIndex": 2
                                            },
                                            "sourceId": "{{vars.item.id}}",
                                            "__replace": "true",
                                            "recordTags": [
                                                "\/api\/3\/tags\/Incidents"
                                            ],
                                            "sourcedata": "{{vars.item | toJSON}}",
                                            "description": "<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Fields<\/th><th width=\\\"250\\\">Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Description<\/td>\n<td>{{vars.item.description}}<\/td><\/tr>\n<td>Risk<\/td>\n<td>{{vars.item.risk}}<\/td><\/tr>\n<td>Type ID<\/td>\n<td>{{vars.item.type_id}}<\/td><\/tr>\n<td>Protocol<\/td>\n<td>{{vars.item.protocol}}<\/td><\/tr>\n<td>Transport Protocol<\/td>\n<td>{{vars.item.transport_protocol}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Source Fields<\/th><th width=\\\"250\\\">Source Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Source ID<\/td>\n<td>{{vars.item.id_src}}<\/td><\/tr>\n<td>Source IP<\/td>\n<td>{{vars.item.ip_src}}<\/td><\/tr>\n<td>Source Port<\/td>\n<td>{{vars.item.port_src}}<\/td><\/tr>\n<td>MAC Source Address<\/td>\n<td>{{vars.item.mac_src}}<\/td><\/tr>\n<td>Source Roles<\/td>\n<td>{{vars.item.src_roles}}<\/td><\/tr>\n<td>Source Types<\/td>\n<td>{{vars.item.types_src}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Destination Fields<\/th><th width=\\\"250\\\">Destination Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Destination ID<\/td>\n<td>{{vars.item.id_dst}}<\/td><\/tr>\n<td>Destination IP<\/td>\n<td>{{vars.item.ip_dst}}<\/td><\/tr>\n<td>Destination Port<\/td>\n<td>{{vars.item.port_dst}}<\/td><\/tr>\n<td>MAC Destination Address<\/td>\n<td>{{vars.item.mac_dst}}<\/td><\/tr>\n<td>Destination Roles<\/td>\n<td>{{vars.item.dst_roles}}<\/td><\/tr>\n<td>Destination Types<\/td>\n<td>{{vars.item.types_dst}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<\/table>",
                                            "mitreattackid": "{{vars.item.mitre_attack_techniques}}",
                                            "slaPercentage": 0
                                        },
                                        "operation": "Overwrite",
                                        "collection": "\/api\/3\/upsert\/incidents",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "435",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "cea7f538-73d9-4d83-a165-f10b5b078f5e"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "List Alerts",
                                    "description": null,
                                    "arguments": {
                                        "arguments": [],
                                        "apply_async": false,
                                        "step_variables": [],
                                        "pass_parent_env": false,
                                        "pass_input_record": false,
                                        "workflowReference": "\/api\/3\/workflows\/f9915c99-8c7d-4c09-9425-d47a95750970"
                                    },
                                    "status": null,
                                    "top": "165",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                                    "group": null,
                                    "uuid": "e143456e-cae2-4fa3-bca9-b773cb796936"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Fetch Alerts",
                                    "description": null,
                                    "arguments": {
                                        "for_each": {
                                            "item": "{{vars.steps.List_Alerts.data | json_query('[?is_incident == `false`]')}}",
                                            "__bulk": false,
                                            "parallel": true,
                                            "condition": ""
                                        },
                                        "arguments": {
                                            "Alert": "{{vars.item}}",
                                            "Incidents With IRI": "{{vars.incident}}"
                                        },
                                        "apply_async": true,
                                        "step_variables": [],
                                        "pass_parent_env": false,
                                        "pass_input_record": false,
                                        "workflowReference": "\/api\/3\/workflows\/ae805c74-dcef-44c8-8b23-9939cac79214"
                                    },
                                    "status": null,
                                    "top": "705",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/74932bdc-b8b6-4d24-88c4-1a4dfbc524f3",
                                    "group": null,
                                    "uuid": "e802bfb1-32c0-4ef6-8eb7-bea0a81d4e82"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Create Record1 -> Update Last Alert Pull Time",
                                    "targetStep": "\/api\/3\/workflow_steps\/8eb12b69-4fbe-4c83-ba6d-a93739e6e5a8",
                                    "sourceStep": "\/api\/3\/workflow_steps\/e802bfb1-32c0-4ef6-8eb7-bea0a81d4e82",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "364ec31a-f52f-4da4-879d-777d4163e279"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Find Incident IRI -> Fetch Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/e802bfb1-32c0-4ef6-8eb7-bea0a81d4e82",
                                    "sourceStep": "\/api\/3\/workflow_steps\/257d8cd6-4005-4e40-9554-19dd3eadc702",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "d08ae16c-459b-41b6-bb35-27672c7a95c7"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "List Alerts -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/93e0d068-c794-4289-8f3f-7e66526fb646",
                                    "sourceStep": "\/api\/3\/workflow_steps\/e143456e-cae2-4fa3-bca9-b773cb796936",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "d00a7dc8-a1b1-43de-8f13-98de51cf11a9"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> List Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/e143456e-cae2-4fa3-bca9-b773cb796936",
                                    "sourceStep": "\/api\/3\/workflow_steps\/38cfb1bc-6309-4448-8121-4f74148ed936",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "2b1b92e1-d7e3-4ba3-b0a3-99ba24af518b"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Create Record -> Find Incident IRI",
                                    "targetStep": "\/api\/3\/workflow_steps\/257d8cd6-4005-4e40-9554-19dd3eadc702",
                                    "sourceStep": "\/api\/3\/workflow_steps\/cea7f538-73d9-4d83-a165-f10b5b078f5e",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "aafc6964-2f52-41f7-b19b-b32bb956cd81"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Create Record",
                                    "targetStep": "\/api\/3\/workflow_steps\/cea7f538-73d9-4d83-a165-f10b5b078f5e",
                                    "sourceStep": "\/api\/3\/workflow_steps\/93e0d068-c794-4289-8f3f-7e66526fb646",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "d58a96c0-bc32-4e1f-88e9-b85b62a6af75"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "bc5e0243-e1b7-46b0-a093-23633df653cd",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "create",
                                "ingest",
                                "nozomi-networks-guardian"
                            ],
                            "schedules": [
                                {
                                    "id": "gAAAAABkAdASwHCsb8-2q1uD_p0pRA7xmj7XlcZDOhEk-9eqYK571tES5S0DSfN7uRl42RAy4Ns2CtL9dMp78Wq-1TZXzG3G2A==",
                                    "crontab": {
                                        "id": 11,
                                        "minute": "01",
                                        "hour": "0",
                                        "day_of_week": "*",
                                        "day_of_month": "*",
                                        "month_of_year": "*",
                                        "timezone": "UTC"
                                    },
                                    "interval": null,
                                    "name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                                    "task": "workflow.tasks.periodic_task",
                                    "args": "[]",
                                    "kwargs": {
                                        "exit_if_running": false,
                                        "wf_iri": "\/api\/3\/workflows\/bc5e0243-e1b7-46b0-a093-23633df653cd",
                                        "createUser": "\/api\/3\/people\/3451141c-bac6-467c-8d72-85e0fab569ce",
                                        "name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                                        "description": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                                        "auth": {
                                            "auth_method": "CS HMAC"
                                        },
                                        "referenceid": null,
                                        "schedule_entry_name": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                                        "schedule_id": "1c62d9e7-25ba-456c-8777-514ac0cdc62b"
                                    },
                                    "queue": null,
                                    "exchange": null,
                                    "routing_key": null,
                                    "headers": "{}",
                                    "priority": 3,
                                    "expires": null,
                                    "expire_seconds": null,
                                    "one_off": false,
                                    "start_time": null,
                                    "enabled": false,
                                    "last_run_at": null,
                                    "total_run_count": 0,
                                    "date_changed": "2023-02-28T09:25:10.159230Z",
                                    "description": "Ingestion_nozomi-networks-guardian_A1_3301581d-6006-4824-bbbc-c5473f82b67c",
                                    "solar": null,
                                    "clocked": null
                                }
                            ]
                        },
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "> Nozomi Networks Guardian > Fetch Alerts",
                            "aliasName": null,
                            "tag": null,
                            "description": "Fetches all alerts from Nozomi Networks Guardian.",
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/3301581d-6006-4824-bbbc-c5473f82b67c",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/820926fa-dfc0-4a58-9997-2f0ebb3b238b",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Set Time Configuration",
                                    "description": null,
                                    "arguments": {
                                        "curr_timestamp": "{{arrow.get(arrow.utcnow().int_timestamp).strftime('%Y-%m-%dT%H:%M:%S.%fZ')}}",
                                        "last_pull_time": "{% if (vars.steps.Get_Macro_Value.data[\"hydra:member\"] | length) < 1%}{{arrow.utcnow().shift(minutes=-vars.Pull_Sample_Events_in_Past_X_Minutes).format('YYYY-MM-DDTHH:mm:ss.ssss')}}Z{% else %}{{vars.steps.Get_Macro_Value.data['hydra:member'][0]['value']}}{% endif %}"
                                    },
                                    "status": null,
                                    "top": "435",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "70b09879-1b6f-4984-85af-3e5f47a462ff"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            },
                                            "_configuration_schema": "[\n{\n    \"title\": \"Pull Threats from Last X Minutes\",\n    \"name\": \"Pull_Sample_Events_in_Past_X_Minutes\",\n    \"type\": \"text\",\n    \"tooltip\": \"Fetch threats from last X minutes. e.g 5\",\n    \"required\": true,\n    \"editable\": true,\n    \"visible\": true,\n    \"value\": 10\n  }\n]",
                                            "NozomiNetworksLastAlertPullTime": "NozomiNetworksLastAlertPullTime_{{vars['audit_info']['cyops_playbook_iri'].split('\/')[-1].replace('-','_')}}"
                                        }
                                    },
                                    "status": null,
                                    "top": "30",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "820926fa-dfc0-4a58-9997-2f0ebb3b238b"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Fetch All Alerts",
                                    "description": null,
                                    "arguments": {
                                        "name": "Nozomi Networks Guardian",
                                        "config": "3301581d-6006-4824-bbbc-c5473f82b67c",
                                        "params": {
                                            "query": "",
                                            "start_time": "{{vars.last_pull_time}}"
                                        },
                                        "version": "1.1.0",
                                        "connector": "nozomi-networks-guardian",
                                        "operation": "fetch_alerts",
                                        "operationTitle": "Fetch All Alerts",
                                        "pickFromTenant": false,
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "570",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
                                    "group": null,
                                    "uuid": "b3f981b7-37a4-4a56-a590-f0b3a010a7b5"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Get Macro Value",
                                    "description": null,
                                    "arguments": {
                                        "params": {
                                            "iri": "\/api\/wf\/api\/dynamic-variable\/?format=json&name={{vars.NozomiNetworksLastAlertPullTime}}",
                                            "body": "",
                                            "method": "GET"
                                        },
                                        "version": "3.2.2",
                                        "connector": "cyops_utilities",
                                        "operation": "make_cyops_request",
                                        "operationTitle": "FSR: Make FortiSOAR API Call",
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
                                    "group": null,
                                    "uuid": "b450d4df-4ea2-4873-801f-4b2c8340131e"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "Pull_Sample_Events_in_Past_X_Minutes": "1000000"
                                    },
                                    "status": null,
                                    "top": "165",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "bbcae75b-7d00-49d0-84dc-29e9d657e9d2"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Save Result",
                                    "description": null,
                                    "arguments": {
                                        "data": "{{vars.steps.Fetch_All_Alerts.data.get(\"result\", [])}}",
                                        "macro_name": "{{vars.NozomiNetworksLastAlertPullTime}}",
                                        "curr_timestamp": "{{vars.curr_timestamp}}"
                                    },
                                    "status": null,
                                    "top": "705",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "c94f8e44-4d7b-421d-9c9b-0c97e0c0defa"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/bbcae75b-7d00-49d0-84dc-29e9d657e9d2",
                                    "sourceStep": "\/api\/3\/workflow_steps\/820926fa-dfc0-4a58-9997-2f0ebb3b238b",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "5bad619c-de90-4ced-ab03-79e7d7307d66"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Get Macro Value -> Set Time Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/70b09879-1b6f-4984-85af-3e5f47a462ff",
                                    "sourceStep": "\/api\/3\/workflow_steps\/b450d4df-4ea2-4873-801f-4b2c8340131e",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "98eee6cd-69c2-449f-812e-9173fbcc3291"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Fetch All Alerts -> Save Result",
                                    "targetStep": "\/api\/3\/workflow_steps\/c94f8e44-4d7b-421d-9c9b-0c97e0c0defa",
                                    "sourceStep": "\/api\/3\/workflow_steps\/b3f981b7-37a4-4a56-a590-f0b3a010a7b5",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "39c4f4ff-2901-4cfb-9a2e-1c698b1895d4"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Get Macro Value",
                                    "targetStep": "\/api\/3\/workflow_steps\/b450d4df-4ea2-4873-801f-4b2c8340131e",
                                    "sourceStep": "\/api\/3\/workflow_steps\/bbcae75b-7d00-49d0-84dc-29e9d657e9d2",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "83f5af7f-8a87-476e-b88a-4c2df537feb8"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Set Time Configuration -> Fetch All Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/b3f981b7-37a4-4a56-a590-f0b3a010a7b5",
                                    "sourceStep": "\/api\/3\/workflow_steps\/70b09879-1b6f-4984-85af-3e5f47a462ff",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "ec0474e3-880f-479f-8760-e31f0481b602"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "f9915c99-8c7d-4c09-9425-d47a95750970",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "fetch",
                                "nozomi-networks-guardian"
                            ]
                        },
                        {
                            "@type": "Workflow",
                            "triggerLimit": null,
                            "name": "Nozomi Networks Guardian > Create Alerts",
                            "aliasName": null,
                            "tag": null,
                            "description": "Create records on FortiSOAR",
                            "isActive": true,
                            "debug": false,
                            "singleRecordExecution": false,
                            "remoteExecutableFlag": false,
                            "parameters": [
                                "Incidents With IRI",
                                "Alert"
                            ],
                            "synchronous": false,
                            "collection": "\/api\/3\/workflow_collections\/3301581d-6006-4824-bbbc-c5473f82b67c",
                            "versions": [],
                            "triggerStep": "\/api\/3\/workflow_steps\/e7b02445-4044-4a06-a4be-6b51364ab04c",
                            "steps": [
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Check alert with parents",
                                    "description": null,
                                    "arguments": {
                                        "conditions": [
                                            {
                                                "option": "No",
                                                "step_iri": "\/api\/3\/workflow_steps\/c2b1a08a-e750-4f76-89b7-8139a1efb59e",
                                                "condition": "{{ vars.alert.parents == [] }}",
                                                "step_name": "Create Record"
                                            },
                                            {
                                                "option": "Yes",
                                                "step_iri": "\/api\/3\/workflow_steps\/e2d4f8d6-09e1-43cc-855a-9a785e07141b",
                                                "condition": "{{ vars.alert.parents != [] }}",
                                                "step_name": "Find Incidents in Alerts"
                                            }
                                        ]
                                    },
                                    "status": null,
                                    "top": "300",
                                    "left": "300",
                                    "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
                                    "group": null,
                                    "uuid": "3878c701-89cf-4b89-973a-30e4c5bf508f"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Configuration",
                                    "description": null,
                                    "arguments": {
                                        "alert": "{{vars.input.params.Alert}}",
                                        "incIRIList": "[]",
                                        "alerts_status_map": "{'open': {{\"AlertStatus\"| picklist(\"Open\")}},'ack': {{\"AlertStatus\"| picklist(\"Investigating\")}}, 'closed': {{\"AlertStatus\"| picklist(\"Closed\")}}}",
                                        "incident_with_iri": "{{vars.input.params['Incidents With IRI']}}",
                                        "alerts_severity_map": "{'0..2': {{'Severity'| picklist('Minimal') }}, '3..4': {{'Severity'| picklist('Low') }}, '5..7': {{'Severity'| picklist('Medium') }}, '8..9': {{'Severity'| picklist('High') }}, '9..10': {{'Severity'| picklist('Critical') }}}"
                                    },
                                    "status": null,
                                    "top": "165",
                                    "left": "300",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "511b1284-05b3-4e12-a6a8-a7c5bafc1a8a"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Correlated Alerts",
                                    "description": null,
                                    "arguments": {
                                        "resource": {
                                            "name": "{{vars.alert.name}}",
                                            "type": "\/api\/3\/picklists\/574a6ee2-7265-4701-815e-cff83b053bce",
                                            "state": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                                            "__link": {
                                                "incidents": "{{vars.incIRIList}}"
                                            },
                                            "source": "Nozomi Networks Guardian",
                                            "status": "{{vars.alert[\"status\"] | resolveRange(vars.alerts_status_map)}}",
                                            "filePath": "{{vars.alert.capture_device}}",
                                            "severity": "{{vars.alert[\"severity\"] | resolveRange(vars.alerts_severity_map)}}",
                                            "sourceId": "{{vars.alert.id}}",
                                            "sourceIp": "{{vars.alert.ip_src}}",
                                            "__replace": "true",
                                            "epochTime": "{{vars.alert.time}}",
                                            "eventTime": "{{arrow.get(vars.alert.created_time).to(\"UTC\").format(\"YYYY-MM-DDTHH:mm:ss\")+'Z'}}",
                                            "recordTags": [
                                                "\/api\/3\/tags\/Alerts"
                                            ],
                                            "sourcePort": "{%if vars.alert.port_src%}{{vars.alert.port_src}}{%endif%}",
                                            "sourcedata": "{{vars.alert | toJSON}}",
                                            "description": "<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Fields<\/th><th width=\\\"250\\\">Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Description<\/td>\n<td>{{vars.alert.description}}<\/td><\/tr>\n<td>Risk<\/td>\n<td>{{vars.alert.risk}}<\/td><\/tr>\n<td>Type ID<\/td>\n<td>{{vars.alert.type_id}}<\/td><\/tr>\n<td>Protocol<\/td>\n<td>{{vars.alert.protocol}}<\/td><\/tr>\n<td>Transport Protocol<\/td>\n<td>{{vars.alert.transport_protocol}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Source Fields<\/th><th width=\\\"250\\\">Source Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Source ID<\/td>\n<td>{{vars.alert.id_src}}<\/td><\/tr>\n<td>MAC Source Address<\/td>\n<td>{{vars.alert.mac_src}}<\/td><\/tr>\n<td>Source Roles<\/td>\n<td>{{vars.alert.src_roles}}<\/td><\/tr>\n<td>Source Types<\/td>\n<td>{{vars.alert.types_src}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Destination Fields<\/th><th width=\\\"250\\\">Destination Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Destination ID<\/td>\n<td>{{vars.alert.id_dst}}<\/td><\/tr>\n<td>MAC Destination Address<\/td>\n<td>{{vars.alert.mac_dst}}<\/td><\/tr>\n<td>Destination Roles<\/td>\n<td>{{vars.alert.dst_roles}}<\/td><\/tr>\n<td>Destination Types<\/td>\n<td>{{vars.alert.types_dst}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<\/table>",
                                            "targetAsset": "{{vars.alert.label_dst}}",
                                            "ackSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "destinationIp": "{{vars.alert.ip_dst}}",
                                            "mitreattackid": "{{vars.alert.mitre_attack_techniques}}",
                                            "respSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "priorityWeight": 1,
                                            "destinationPort": "{%if vars.alert.port_dst%}{{vars.alert.port_dst}}{%endif%}",
                                            "escalatedtoincident": "\/api\/3\/picklists\/fa12313b-66af-4a2e-864e-a5f19241b734",
                                            "alertRemainingAckSLA": 0
                                        },
                                        "_showJson": false,
                                        "operation": "Append",
                                        "collection": "\/api\/3\/upsert\/alerts",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": {
                                            "alert": "{{vars.steps.Create_Correlated_Alerts}}"
                                        }
                                    },
                                    "status": null,
                                    "top": "570",
                                    "left": "475",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "79d3dff2-71e2-4040-b33e-018b8dd7dc0d"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Add Comment In Incident",
                                    "description": null,
                                    "arguments": {
                                        "resource": {
                                            "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                                            "people": [],
                                            "content": "<p>Alert <a href=\"{{vars.request.baseUri}}\/modules\/alerts\/{{vars.alert.uuid}}\" target=\"_blank\" rel=\"noopener\">{{vars.alert.name}}<\/a> got correlated.<\/p>",
                                            "__replace": "",
                                            "incidents": "{{vars.incIRIList}}",
                                            "isImportant": false,
                                            "peopleUpdated": false
                                        },
                                        "operation": "Overwrite",
                                        "collection": "\/api\/3\/comments",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "705",
                                    "left": "475",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "a02c0ed6-4d07-4f7c-b1ed-78529b9e5a63"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Create Record",
                                    "description": null,
                                    "arguments": {
                                        "resource": {
                                            "name": "{{vars.alert.name}}",
                                            "type": "\/api\/3\/picklists\/574a6ee2-7265-4701-815e-cff83b053bce",
                                            "state": "\/api\/3\/picklists\/a1bac09b-1441-45aa-ad1b-c88744e48e72",
                                            "source": "Nozomi Networks Guardian",
                                            "status": "{{vars.alert[\"status\"] | resolveRange(vars.alerts_status_map)}}",
                                            "filePath": "{{vars.alert.capture_device}}",
                                            "severity": "{{vars.alert[\"severity\"] | resolveRange(vars.alerts_severity_map)}}",
                                            "sourceId": "{{vars.alert.id}}",
                                            "sourceIp": "{{vars.alert.ip_src}}",
                                            "__replace": "true",
                                            "epochTime": "{{vars.alert.time}}",
                                            "eventTime": "{{arrow.get(vars.alert.created_time).to(\"UTC\").format(\"YYYY-MM-DDTHH:mm:ss\")+'Z'}}",
                                            "recordTags": [
                                                "\/api\/3\/tags\/Alerts"
                                            ],
                                            "sourcePort": "{%if vars.alert.port_src%}{{vars.alert.port_src}}{%endif%}",
                                            "sourcedata": "{{vars.alert | toJSON}}",
                                            "description": "<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Fields<\/th><th width=\\\"250\\\">Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Description<\/td>\n<td>{{vars.alert.description}}<\/td><\/tr>\n<td>Risk<\/td>\n<td>{{vars.alert.risk}}<\/td><\/tr>\n<td>Type ID<\/td>\n<td>{{vars.alert.type_id}}<\/td><\/tr>\n<td>Protocol<\/td>\n<td>{{vars.alert.protocol}}<\/td><\/tr>\n<td>Transport Protocol<\/td>\n<td>{{vars.alert.transport_protocol}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Source Fields<\/th><th width=\\\"250\\\">Source Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Source ID<\/td>\n<td>{{vars.alert.id_src}}<\/td><\/tr>\n<td>MAC Source Address<\/td>\n<td>{{vars.alert.mac_src}}<\/td><\/tr>\n<td>Source Roles<\/td>\n<td>{{vars.alert.src_roles}}<\/td><\/tr>\n<td>Source Types<\/td>\n<td>{{vars.alert.types_src}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<table border=\\\"1\\\"><thead><tr><th width=\\\"250\\\">Destination Fields<\/th><th width=\\\"250\\\">Destination Values<\/th><\/tr><\/thead>\n<tbody>\n<tr><td>Destination ID<\/td>\n<td>{{vars.alert.id_dst}}<\/td><\/tr>\n<td>MAC Destination Address<\/td>\n<td>{{vars.alert.mac_dst}}<\/td><\/tr>\n<td>Destination Roles<\/td>\n<td>{{vars.alert.dst_roles}}<\/td><\/tr>\n<td>Destination Types<\/td>\n<td>{{vars.alert.types_dst}}<\/td><\/tr>\n<\/tbody>\n<\/table>\n<\/table>",
                                            "targetAsset": "{{vars.alert.label_dst}}",
                                            "ackSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "destinationIp": "{{vars.alert.ip_dst}}",
                                            "mitreattackid": "{{vars.alert.mitre_attack_techniques}}",
                                            "respSlaStatus": "\/api\/3\/picklists\/72979f64-e8b9-4888-a965-957e0ec24818",
                                            "priorityWeight": 1,
                                            "destinationPort": "{%if vars.alert.port_dst%}{{vars.alert.port_dst}}{%endif%}",
                                            "escalatedtoincident": "\/api\/3\/picklists\/2128a09c-153d-4db3-985d-de6be33deae5",
                                            "alertRemainingAckSLA": 0
                                        },
                                        "_showJson": false,
                                        "operation": "Append",
                                        "collection": "\/api\/3\/upsert\/alerts",
                                        "__recommend": [],
                                        "fieldOperation": {
                                            "recordTags": "Overwrite"
                                        },
                                        "step_variables": []
                                    },
                                    "status": null,
                                    "top": "435",
                                    "left": "125",
                                    "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
                                    "group": null,
                                    "uuid": "c2b1a08a-e750-4f76-89b7-8139a1efb59e"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Find Incidents in Alerts",
                                    "description": null,
                                    "arguments": {
                                        "incident": "{% for item in vars.alert.parents %}{{vars.incIRIList.append(vars.incident_with_iri.get(item))}}{% endfor %}"
                                    },
                                    "status": null,
                                    "top": "435",
                                    "left": "475",
                                    "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
                                    "group": null,
                                    "uuid": "e2d4f8d6-09e1-43cc-855a-9a785e07141b"
                                },
                                {
                                    "@type": "WorkflowStep",
                                    "name": "Start",
                                    "description": null,
                                    "arguments": {
                                        "step_variables": {
                                            "input": {
                                                "params": []
                                            }
                                        }
                                    },
                                    "status": null,
                                    "top": "30",
                                    "left": "300",
                                    "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
                                    "group": null,
                                    "uuid": "e7b02445-4044-4a06-a4be-6b51364ab04c"
                                }
                            ],
                            "routes": [
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Configuration -> Check alert with parents",
                                    "targetStep": "\/api\/3\/workflow_steps\/3878c701-89cf-4b89-973a-30e4c5bf508f",
                                    "sourceStep": "\/api\/3\/workflow_steps\/511b1284-05b3-4e12-a6a8-a7c5bafc1a8a",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "9a3efa2e-bbde-496b-9aff-fae8c0aeeae3"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Find Incidents in Alerts -> Create Correlated Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/79d3dff2-71e2-4040-b33e-018b8dd7dc0d",
                                    "sourceStep": "\/api\/3\/workflow_steps\/e2d4f8d6-09e1-43cc-855a-9a785e07141b",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "35b8bb11-4a4c-41d7-8426-afa4ca6b6396"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Create Correlated Alerts -> Add Comment In Incident",
                                    "targetStep": "\/api\/3\/workflow_steps\/a02c0ed6-4d07-4f7c-b1ed-78529b9e5a63",
                                    "sourceStep": "\/api\/3\/workflow_steps\/79d3dff2-71e2-4040-b33e-018b8dd7dc0d",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "5ce3bb9c-1a09-4687-9073-45b3c987ebd0"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Start -> Configuration",
                                    "targetStep": "\/api\/3\/workflow_steps\/511b1284-05b3-4e12-a6a8-a7c5bafc1a8a",
                                    "sourceStep": "\/api\/3\/workflow_steps\/e7b02445-4044-4a06-a4be-6b51364ab04c",
                                    "label": null,
                                    "isExecuted": false,
                                    "uuid": "1b18666e-8b5a-44f8-8679-ed7536d2ae96"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Check alert with parents -> Create Record",
                                    "targetStep": "\/api\/3\/workflow_steps\/c2b1a08a-e750-4f76-89b7-8139a1efb59e",
                                    "sourceStep": "\/api\/3\/workflow_steps\/3878c701-89cf-4b89-973a-30e4c5bf508f",
                                    "label": "No",
                                    "isExecuted": false,
                                    "uuid": "8cda19a5-470f-4597-a95c-5c06b9a9314d"
                                },
                                {
                                    "@type": "WorkflowRoute",
                                    "name": "Check alert with parents -> Find Incidents in Alerts",
                                    "targetStep": "\/api\/3\/workflow_steps\/e2d4f8d6-09e1-43cc-855a-9a785e07141b",
                                    "sourceStep": "\/api\/3\/workflow_steps\/3878c701-89cf-4b89-973a-30e4c5bf508f",
                                    "label": "Yes",
                                    "isExecuted": false,
                                    "uuid": "8c1a540d-d5a9-47ab-abb7-87339c612e56"
                                }
                            ],
                            "groups": [],
                            "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
                            "uuid": "ae805c74-dcef-44c8-8b23-9939cac79214",
                            "owners": [],
                            "isPrivate": false,
                            "deletedAt": null,
                            "recordTags": [
                                "dataingestion",
                                "create",
                                "nozomi-networks-guardian"
                            ]
                        }
                    ],
                    "image": null,
                    "uuid": "3301581d-6006-4824-bbbc-c5473f82b67c",
                    "deletedAt": null,
                    "recordTags": []
                }
            ],
            "exported_tags": [
                "dataingestion",
                "create",
                "ingest",
                "nozomi-networks-guardian",
                "fetch"
            ],
            "globalVariables": []
        }
    }
]